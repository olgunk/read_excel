package pdf;

import reader.ReadExcel;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.MalformedURLException;
import java.util.Date;
import java.util.List;

import javax.swing.JFrame;
import javax.swing.SwingUtilities;

import jxl.Cell;
import jxl.CellType;
import jxl.Sheet;
import jxl.Workbook;
import jxl.read.biff.BiffException;
import org.w3c.dom.Text;

import reader.ReadExcel;

import com.itextpdf.text.Anchor;
import com.itextpdf.text.BadElementException;
import com.itextpdf.text.BaseColor;
import com.itextpdf.text.Chapter;
import com.itextpdf.text.Chunk;
import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.Element;
import com.itextpdf.text.Font;
import com.itextpdf.text.Header;

import com.itextpdf.text.ListItem;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.Phrase;
import com.itextpdf.text.Section;
import com.itextpdf.text.pdf.PdfContentByte;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfWriter;
import com.itextpdf.text.Image;


public class createpdf {
	private static String FILE = "storeMate_Rossmann_GS1-MHD-Verfall_Codes.pdf";
	private static Font catFont = new Font(Font.FontFamily.TIMES_ROMAN, 18,
	        Font.BOLD);
	private static Font canoFont = new Font(Font.FontFamily.TIMES_ROMAN, 16,
	        Font.BOLD);
	private static Font smallBold = new Font(Font.FontFamily.TIMES_ROMAN, 12,
	        Font.BOLD);
	
	private static String excelfile = "C:\\Users\\Olgun\\git\\read_excel\\de.vogella.java.excel\\BarcodeLi.xls";
	private static String kopfheader = "C:\\Users\\Olgun\\git\\read_excel\\de.vogella.java.excel\\Kopf.png";
	
	public static void main(String[] args) {
		try {
			ReadExcel excelTabelle = new ReadExcel();
			excelTabelle.setInputFile(excelfile);
			excelTabelle.read();
			Document document = new Document();
			PdfWriter.getInstance(document, new FileOutputStream(FILE));
			document.open();
			addMetaData(document);
			addTitlePage(document);
			addContent(document);
			document.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	
	private static void addMetaData(Document document) throws DocumentException {
		
		document.addTitle("Artikelcodes mit MHD und Verfallsdatum");
		document.addAuthor("Olgun Katrag");
		document.addCreator("Olgun Katrag");
		
		document.add(new Paragraph("Hello World", smallBold));
	}
	
	private static void addTitlePage(Document document)
	        throws DocumentException {
		Paragraph preface = new Paragraph();
		// We add one empty line
		addEmptyLine(preface, 1);
		// Lets write a big header
		preface.add(new Paragraph("Artikelcodes mit MHD und Verfallsdatum", catFont));
		
		addEmptyLine(preface, 1);
		// Will create: Report generated by: _name, _date
		preface.add(new Paragraph(
		        "Report generated by: " + System.getProperty("user.name") + ", " + new Date(), //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$
		        smallBold));
		
		// addEmptyLine(preface, 8);
		
		document.add(preface);
		// Start a new page
		document.newPage();
		
	}
	
	private static void addContent(Document document) throws DocumentException,
	        IOException {
		/*      Variablen   deklaration */
		List<String> productHeader = getProductHeader();
		List<String> barcodeliste = getProductList();
		int count = getImageCount();
		int totalPage = getTotalPageNumber();
		int pageCount = 0;
		int neueseite = 1;
		Paragraph seite = new Paragraph();
		seite.setAlignment(Element.ALIGN_RIGHT);
		
		/*      Image   deklaration */
		Image header_image = Image.getInstance(kopfheader);
		header_image.setAlignment(Image.MIDDLE);
		header_image.scalePercent(50);
		document.add(header_image);
		
		for (int i = 2; i <= count + 1; i++) {
			if (i == 2) {				
				document.add(new Paragraph("Artikel nur mit Mindesthaltbarkeitsdatum (MHD)", canoFont));
				document.add(Chunk.NEWLINE);
			}
			else if (i == 7) {				
				document.add(new Paragraph("Artikel nur mit Verfallsdatum(MHD)", canoFont));
				document.add(Chunk.NEWLINE);
			}
			else if (i == 12) {				
				document.add(new Paragraph("Artikel mit MHD und Verfallsdatum", canoFont));
				document.add(Chunk.NEWLINE);
			}
			else if (i == 20) {		
				document.newPage();
				document.add(new Paragraph("Artikel mit MHD und Verfallsdatum: Sonderfall01", canoFont));
				document.add(Chunk.NEWLINE);
			}
			
			document.add(new Paragraph(productHeader.get(i)));
			Image barcode = Image.getInstance("c:\\Barcodes\\Barcodes" + i + ".png");
			barcode.setAlignment(Image.LEFT);
			barcode.scalePercent(25);
			document.add(new Paragraph(barcodeliste.get(i-2).replace(";", "")));
			document.add(barcode);
			document.add(Chunk.NEWLINE);
			
			if (i != count + 1) {
				if (neueseite % 5 == 0) {
					pageCount += 1;
					Chunk chunk = new Chunk("Page " + pageCount + " / " + totalPage);
					seite.add(chunk);
					document.add(Chunk.NEWLINE);
					document.add(Chunk.NEWLINE);
					document.add(seite);
					seite.removeAll(seite);
					document.newPage();
					document.add(header_image);
					
				}
			}
			neueseite += 1;
			
		}
	}
	
	private static void addEmptyLine(Paragraph paragraph, int number) {
		for (int i = 0; i < number; i++) {
			paragraph.add(new Paragraph(""));
		}
	}
	
	public static int getTotalPageNumber() throws IOException {
		/*      Variablen   deklaration */
		int neueseite = 1;
		int count = getImageCount();
		int pageCount = 1;
		
		
		for (int i = 2; i <= count + 1; i++) {
			if (i != count - 1) {
				if (neueseite % 5 == 0) {
					pageCount += 1;
				}
			}
			neueseite += 1;
		}
		return pageCount;
	}
	
	public static int getImageCount() throws IOException {
		/*      Variablen   deklaration */
		ReadExcel excelTabelle = new ReadExcel();
		excelTabelle.setInputFile(excelfile);
		Sheet sheet = excelTabelle.excselinhalt();
		int count = excelTabelle.getExcelTabelleCount(sheet);
		return count;
	}
	
	public static List<String> getProductHeader() throws IOException {
		ReadExcel excelTabelle = new ReadExcel();
		excelTabelle.setInputFile(excelfile);
		Sheet sheet = excelTabelle.excselinhalt();
		List<String> headerliste = excelTabelle.getProductHeader(sheet);
		return headerliste;
	}
	
	public static List<String> getProductList() throws IOException {
		ReadExcel exceltabelle = new ReadExcel();
		exceltabelle.setInputFile(excelfile);
		Sheet sheet = exceltabelle.excselinhalt();
		List<String> barcodelist = exceltabelle.getExcselTabelleList(sheet);
		return barcodelist;
	}
	
}
